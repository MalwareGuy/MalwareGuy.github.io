<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Patching - Malware Guy</title>
<meta name="description" content="I wrote this post as I thought it would be fun to explore some reverse engineering techniques — in (almost) simplified terms! Typically, patching can be used to bypass detection methods employed by strung malware authors who want to add on a bit of challenge to slow down and increase the difficulty of analysis.">


  <meta name="author" content="Malware Guy">
  
  <meta property="article:author" content="Malware Guy">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_GB">
<meta property="og:site_name" content="Malware Guy">
<meta property="og:title" content="Patching">
<meta property="og:url" content="http://localhost:4000/RE-notes/patching.html">


  <meta property="og:description" content="I wrote this post as I thought it would be fun to explore some reverse engineering techniques — in (almost) simplified terms! Typically, patching can be used to bypass detection methods employed by strung malware authors who want to add on a bit of challenge to slow down and increase the difficulty of analysis.">



  <meta property="og:image" content="http://localhost:4000/assets/images/banner.png">





  <meta property="article:published_time" content="2022-12-14T00:00:00+00:00">





  

  


<link rel="canonical" href="http://localhost:4000/RE-notes/patching.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Malware Guy",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Malware Guy Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Malware Guy
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="/assets/images/banner.png" alt="Patching" class="page__hero-image">
  
  
</div>







<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://localhost:4000/">
        <img src="/assets/images/PNGTuber_Malware_Talk.png" alt="Malware Guy" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Malware Guy</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>Malware Hunting VTuber</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="https://www.twitch.tv/malware_guy" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitch" aria-hidden="true"></i><span class="label">Twitch</span></a></li>
          
        
          
            <li><a href="https://twitter.com/themalwareguy" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/MalwareGuy" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/channel/UCKLRrI3yzes4p8GpWAdwevg" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">YouTube</span></a></li>
          
        
          
            <li><a href="https://discord.gg/kvU3kvt4Qb" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-discord" aria-hidden="true"></i><span class="label">Discord</span></a></li>
          
        
          
            <li><a href="https://infosec.exchange/@malware_guy" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-mastodon" aria-hidden="true"></i><span class="label">Mastodon</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Patching">
    <meta itemprop="description" content="I wrote this post as I thought it would be fun to explore some reverse engineering techniques — in (almost) simplified terms! Typically, patching can be used to bypass detection methods employed by strung malware authors who want to add on a bit of challenge to slow down and increase the difficulty of analysis.">
    <meta itemprop="datePublished" content="2022-12-14T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/RE-notes/patching.html" class="u-url" itemprop="url">Patching
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#bypass-methods">Bypass Methods</a><ul><li><a href="#reversing-the-logic">Reversing the logic</a></li><li><a href="#fill-with-nops">Fill with NOPs</a></li><li><a href="#opcode-patching">Opcode Patching</a></li><li><a href="#direct-patching">Direct Patching</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#references">References</a></li></ul>

            </nav>
          </aside>
        
        <p>I wrote this post as I thought it would be fun to explore some reverse engineering techniques — in (almost) simplified terms! Typically, patching can be used to bypass detection methods employed by strung malware authors who want to add on a bit of challenge to slow down and increase the difficulty of analysis.</p>

<p>Even with something as simple as <code class="language-plaintext highlighter-rouge">IsDebuggerPresent</code> or <code class="language-plaintext highlighter-rouge">Sleep</code> or complex techniques such as the use of Structured Exception Handlers, you can apply these methods to defeat the defences employed by malware which would otherwise lead to undesirable results. When it also comes to slightly more complicated detection methods (use of the <code class="language-plaintext highlighter-rouge">rdtsc</code> instruction for time-based detection, Structured Exception Handling or hardware breakpoint detection), it is left to the analyst’s imagination as well as their knowledge and experience to defeat those mechanisms.</p>

<p>Using a plugin like ScyllaHide within x64dbg can be a massive shortcut — it may prevent the debugger from being detected by the malware specimen, but that would not stop it from discovering specific things like parent processes, monitoring and analysis tools running or installed on systems, or utilising certain sequences of Assembly instructions that would reveal that it is being run inside a virtual machine. However, combining or applying either of these where you can would help you adapt to pretty much anything malware throws at you, and you become a much more effective reverse engineer. Repeat after me, patching is applying duct tape to <del>all your problems</del> logic!</p>

<figure class="">
  <img src="/assets/images/patching/20221213193543.png" alt="" /></figure>

<p>A short disclaimer though, this post is intended to cover some basic techniques that will face off <em>basic</em> evasion methods. Unfortunately I will not cover topics such as devirtualising Assembly instructions as I am not yet on that level, but I possibly could in a future post.</p>

<p>That said, patching is pretty much a core task in any reverse engineer’s toolkit regardless of skill level, so allow me to take you through a few!</p>

<h2 id="bypass-methods">Bypass Methods</h2>
<p><strong>If you would like to follow along, feel free to download the IcedID sample within the References section of this post! You are invited to change the <em>DLL can move</em> property through CFF Explorer within <code class="language-plaintext highlighter-rouge">DllCharacteristics</code>!</strong></p>

<figure class="">
  <img src="/assets/images/patching/20221213194039.png" alt="" /></figure>

<h3 id="reversing-the-logic">Reversing the logic</h3>
<p>Just like human beings, malware and software programs as a whole operate on logic, just without the feelings holding them back! To put it simply, programs are series of instructions that have a control flow based on the conditions of their environment (user input, running procesesses, OS-determined variables etc.) and change their behaviours to adapt based on those outcomes. Some may be within your control while others are not, but inside a debugger and disassembler, the world is yours to rule.</p>

<figure class="">
  <img src="/assets/images/patching/20221127012139.png" alt="" /></figure>

<p>In the below psuedocode, let’s imagine the malware specimen had called an anti-debugger detection method, and the variable of the result was stored and checked to determine the next behaviours it would exhibit:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// perform some code based on the successful if statement</span>
<span class="p">}</span>

<span class="k">else</span>
<span class="p">{</span>
    <span class="c1">// do something else</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Within Assembly, this code would be disassembled as the following:</p>

<pre><code class="language-asm">cmp eax, 1
jz ResultWasOne
xor eax, eax ; XORing out eax would store 0 in the return value, and also indicate the conditional jump wasn't taken
ret

ResultWasOne:
xchg eax, eax ; perform some code based on the successful if statement
</code></pre>

<p>Changing <code class="language-plaintext highlighter-rouge">jz</code> to <code class="language-plaintext highlighter-rouge">jnz</code> cause the complete opposite effect to happen — the function ends up returning <code class="language-plaintext highlighter-rouge">0</code> (essentially performing the XOR operation on <code class="language-plaintext highlighter-rouge">eax</code> within Assembly) and moving the flow of the program to the caller of the function.</p>

<p>Within your tools, you can use graph views to determine where the jump actually goes and what happens based on this decision. To make your life slightly easier, do the following to show instruction addresses while in Graph View in IDA - <code class="language-plaintext highlighter-rouge">Graph view &gt; Options &gt; General &gt; Disassembly &gt; Line prefixes (graph)</code>.</p>

<p>The colours of arrows can also be generally helpful for understanding the control flow of a program:</p>
<ul>
  <li>Red signifies an unsuccessful result</li>
  <li>Green signifies a successful result</li>
  <li>Code blocks that branch out across numerous blue arrows often indicate a jump table is in use — this is particularly common in keyloggers and encryption algorithms, possibly even more when malware authors had attempted to obfuscate their flow!</li>
</ul>

<p>Inside the IcedID specimen, I will be covering the two anti-debugging techniques:</p>
<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">IsDebuggerPresent</code>, which actually checks the <code class="language-plaintext highlighter-rouge">PEB.BeingDebugged</code> member within the PEB behind the scenes, and if it is set to <code class="language-plaintext highlighter-rouge">1</code>, the return value is also <code class="language-plaintext highlighter-rouge">1</code> (<a href="https://learn.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb">reference</a>).</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">OutputDebugStringW</code> method relies on the fact that if the process is being debugged, then the return value in <code class="language-plaintext highlighter-rouge">eax</code> would be a valid address inside the virtual address of the process, otherwise will be <code class="language-plaintext highlighter-rouge">0</code> or <code class="language-plaintext highlighter-rouge">1</code> as mentioned. Since <code class="language-plaintext highlighter-rouge">0</code> and <code class="language-plaintext highlighter-rouge">1</code> are not valid virtual addresses, if the program attempts to access those addresses, a memory access violation exception (exception code <code class="language-plaintext highlighter-rouge">0xC0000005</code>) will occur, the execution will then be transferred to an exception handler and the program will be able to detect that the calling process is not debugged. If no exception occurs, then it means that the calling process is running under a debugger.</p>
  </li>
</ul>

<p>Notice how the opcodes (<code class="language-plaintext highlighter-rouge">Options &gt; General &gt; Number of opcodes (graph)</code> — set to <code class="language-plaintext highlighter-rouge">8</code>) for each conditional jump inside each anti-debug technique changes within the screenshots:</p>

<p><strong>Before:</strong></p>
<figure class="">
  <img src="/assets/images/patching/20221213103852.png" alt="" /></figure>

<p><strong>After:</strong></p>
<figure class="">
  <img src="/assets/images/patching/20221213104545.png" alt="" /></figure>

<p>Reversing the logic of the instructions will cause the program to behave in the exact opposite way it was originally written. To keep track of your patched instructions, you can view them in IDA:</p>

<figure class="">
  <img src="/assets/images/patching/20221213104609.png" alt="" /></figure>

<h3 id="fill-with-nops">Fill with NOPs</h3>
<p>The <code class="language-plaintext highlighter-rouge">nop</code> instruction has many uses, and it is so versatile that it is being used by malware authors and reverse engineers alike! In exploit dev, <code class="language-plaintext highlighter-rouge">nop</code> sleds are normally used to allow malware to unpack their shellcode into unoccupied regions of memory within their target.</p>

<figure class="">
  <img src="/assets/images/patching/nop-baby.png" alt="" /></figure>

<p>In malware development, its logic can also be used in a series of instructions to waste analysis time with calculations that land back to square one, such an example being <code class="language-plaintext highlighter-rouge">push eax</code>, <code class="language-plaintext highlighter-rouge">xchg eax, eax</code> <code class="language-plaintext highlighter-rouge">add eax, 1</code>, <code class="language-plaintext highlighter-rouge">pop eax</code>.</p>

<p>In the case of reverse engineering, filling an area of a program with a series of <code class="language-plaintext highlighter-rouge">nop</code> instructions is essentially replacing their opcodes with <code class="language-plaintext highlighter-rouge">90</code> and causing it to do absolutely <em>nothing</em> in that short region for the reward of <em>everything</em> your specimen has to offer!</p>

<p><strong>Before:</strong></p>
<figure class="">
  <img src="/assets/images/patching/20221213195522.png" alt="" /></figure>

<p><strong>After</strong>:</p>
<figure class="">
  <img src="/assets/images/patching/20221214100618.png" alt="" /></figure>

<figure class="">
  <img src="/assets/images/patching/nope.png" alt="" /></figure>

<p>Notice how x64dbg fills the space occupied by the previous anti-analysis opcodes with that many bytes! Which takes us to the following section…</p>

<h3 id="opcode-patching">Opcode Patching</h3>
<p><code class="language-plaintext highlighter-rouge">jz</code>, <code class="language-plaintext highlighter-rouge">jnz</code>, <code class="language-plaintext highlighter-rouge">jg</code>, <code class="language-plaintext highlighter-rouge">jl</code></p>

<p>These have one thing in common; apart from starting with a <code class="language-plaintext highlighter-rouge">j</code>, they are all assembly instructions for which their purpose in comparisons are facilitate conditional jumps, and they all have opcodes!</p>

<p>Here is an example of a conditional jump:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">74 07</code></li>
</ul>

<p><code class="language-plaintext highlighter-rouge">74</code> stands for <code class="language-plaintext highlighter-rouge">jz</code> or <code class="language-plaintext highlighter-rouge">je</code>, and the argument causes the program to make a jump <code class="language-plaintext highlighter-rouge">07</code> bytes forward (moving the instruction pointer that many bytes away) if the <code class="language-plaintext highlighter-rouge">ZF</code> flag is not set to <code class="language-plaintext highlighter-rouge">1</code>. Re-assembling the opcodes from <code class="language-plaintext highlighter-rouge">74 07</code> to <code class="language-plaintext highlighter-rouge">74 00</code> would essentially be a <code class="language-plaintext highlighter-rouge">nop</code>! To make better sense of it, here is a visualisation of what a patched jump would look like:</p>

<figure class="">
  <img src="/assets/images/patching/jump.gif" alt="" /></figure>

<p>To perform this within IDA, click <code class="language-plaintext highlighter-rouge">Edit &gt; Patch program &gt; Change byte</code> and change <code class="language-plaintext highlighter-rouge">07</code> to <code class="language-plaintext highlighter-rouge">00</code> like shown in the screenshot:</p>

<figure class="">
  <img src="/assets/images/patching/20221213194500.png" alt="" /></figure>

<p>Notice the difference on the arrows as well as the jump destination!</p>

<figure class="">
  <img src="/assets/images/patching/20221213194615.png" alt="" /></figure>

<p>This can also apply for unconditional jumps (<code class="language-plaintext highlighter-rouge">jmp</code>), but you must know where you’re landing to make sure you don’t break the program! On another note, being aware of opcodes can also be important if you want to write YARA rules for code reuse across malware within a campaign. Although you do not need to memorise them, here is a <a href="http://ref.x86asm.net/coder32.html">reference</a>.</p>

<h3 id="direct-patching">Direct Patching</h3>
<p>This method would be slightly more challenging, seeing as you would require some knowledge around the PE format (long live <a href="https://learn.microsoft.com/en-us/windows/win32/debug/pe-format">MSDN</a>!)</p>

<p>To be successful with this method, you use the following equation to calculate the offset and directly edit a binary inside a hex editor:</p>

<p><code class="language-plaintext highlighter-rouge">Offset = VirtualAddress - (ImageBase + RelativeVirtualAddressOfSection) + PointerToRawData</code></p>

<p>To start, you’d have to retrieve the virtual address from IDA or x64dbg — in this case, we will use <code class="language-plaintext highlighter-rouge">0x40863E</code>, as this was one of the virtual addresses for the argument for the conditional jump spotted within the IcedID specimen.</p>

<p>Next, you would need the relative virtual address of the section (typically calculated through <code class="language-plaintext highlighter-rouge">RelativeVirtualAddress = VirtualAddress - ImageBase</code>) as well as the value stored within  <code class="language-plaintext highlighter-rouge">PointerToRawData</code>. Detect It Easy simplifies finding this is as much as possible, although you can also have a look at the structure from <a href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_section_header">MSDN</a>.</p>

<figure class="">
  <img src="/assets/images/patching/20221213190119.png" alt="" /></figure>

<p>While we’re at it, we can also obtain the value of <code class="language-plaintext highlighter-rouge">ImageBase</code>, which is usually <code class="language-plaintext highlighter-rouge">0x400000</code> by default for 32-bit EXEs and <code class="language-plaintext highlighter-rouge">0x10000000</code> for DLLs (you can find out more <a href="https://learn.microsoft.com/en-us/cpp/build/reference/base-base-address">here</a>).</p>

<figure class="">
  <img src="/assets/images/patching/20221213192900.png" alt="" /></figure>

<p>Finally, we are left with the final equation: <code class="language-plaintext highlighter-rouge">Offset = 0x40863E - (0x1000 + 0x400000) + 0x400</code>. To get the offset, we would perform the following inside a hex calculator, which can either be your regular RE tools or even the default Windows calculator:</p>

<figure class="">
  <img src="/assets/images/patching/20221213190221.png" alt="" /></figure>

<p>At offset <code class="language-plaintext highlighter-rouge">0x7A3E</code> within HxD, we can see the exact instructions we were looking for!</p>

<figure class="">
  <img src="/assets/images/patching/20221213190426.png" alt="" /></figure>

<p>You can also use tools such as CFF Explorer, PE-bear and even Python’s <code class="language-plaintext highlighter-rouge">pefile</code> module to patch binaries while they aren’t loaded into memory. Several of them even contain built-in offset calculators and hex editors!</p>

<figure class="">
  <img src="/assets/images/patching/20221213184810.png" alt="" /></figure>

<h2 id="conclusion">Conclusion</h2>
<p>Whether you use a disassembler, debugger, or even a simple hex editor, patching can help you circumvent anti-analysis detections used by malware. In the case of dnSpy, it can even be as simple as right-clicking an area of the program you don’t like, <code class="language-plaintext highlighter-rouge">Edit IL Instructions</code>, making the changes then saving the module to patch the binary (see an example <a href="https://www.malwareguy.tech/Hunts/redline-stealer.html#anti-debugging-dnspy">here</a>). This is even super effective against malware that attempts to verify checksums against its own executable sections to make double sure that it isn’t being analysed. If you run into trouble, you can always look at the mitigations recommended by <a href="https://unprotect.it/">Unprotect.it</a> and CheckPoint’s <a href="https://anti-debug.checkpoint.com/">Anti-Debug</a>. You can also have a look at several anti-analysis techniques from an adversary’s point of view inside the <a href="https://github.com/LordNoteworthy/al-khaser">Al-Khaser</a> GitHub repo.</p>

<p>Whenever you are doing this via a debugger, make sure you also <strong>save</strong> the file, as the patches done will only apply for the one time the PE is loaded into memory! Inside x64dbg: <code class="language-plaintext highlighter-rouge">File &gt; Patch file</code>:</p>

<figure class="">
  <img src="/assets/images/patching/20221213200705.png" alt="" /></figure>

<p>If you found this post useful, please share it with other beginner reverse engineers who are just starting out, and feel free to reach out to me on any of my social media handles if you have any questions or comments on the post!</p>

<p>Mini-challenge: Try to change the <code class="language-plaintext highlighter-rouge">DllCharacteristics</code> field of the optional header without relying on CFF Explorer! Check <a href="https://learn.microsoft.com/en-us/windows/win32/debug/pe-format#dll-characteristics">here</a> for clues.</p>

<h2 id="references">References</h2>
<p>SHA256: <code class="language-plaintext highlighter-rouge">76cd290b236b11bd18d81e75e41682208e4c0a5701ce7834a9e289ea9e06eb7e</code>
<a href="https://bazaar.abuse.ch/sample/76cd290b236b11bd18d81e75e41682208e4c0a5701ce7834a9e289ea9e06eb7e/">https://bazaar.abuse.ch/sample/76cd290b236b11bd18d81e75e41682208e4c0a5701ce7834a9e289ea9e06eb7e/</a></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#cff-explorer" class="page__taxonomy-item p-category" rel="tag">CFF Explorer</a><span class="sep">, </span>
    
      <a href="/tags/#detect-it-easy" class="page__taxonomy-item p-category" rel="tag">Detect It Easy</a><span class="sep">, </span>
    
      <a href="/tags/#hxd" class="page__taxonomy-item p-category" rel="tag">HxD</a><span class="sep">, </span>
    
      <a href="/tags/#ida" class="page__taxonomy-item p-category" rel="tag">IDA</a><span class="sep">, </span>
    
      <a href="/tags/#re-notes" class="page__taxonomy-item p-category" rel="tag">RE Notes</a><span class="sep">, </span>
    
      <a href="/tags/#x64dbg" class="page__taxonomy-item p-category" rel="tag">x64dbg</a>
    
    </span>
  </p>




        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-12-14T00:00:00+00:00">December 14, 2022</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Patching%20http%3A%2F%2Flocalhost%3A4000%2FRE-notes%2Fpatching.html" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2FRE-notes%2Fpatching.html" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2FRE-notes%2Fpatching.html" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/Course-Reviews/eCTHPv2.html" class="pagination--pager" title="My eCTHPv2 Experiences
">Previous</a>
    
    
      <a href="/Hunts/nppspy.html" class="pagination--pager" title="The Curious Case of MPNotify &amp; NPPSPY
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/zero2auto1/dumpsterfire.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Hunts/zero2automated-jan-2023-challenge.html" rel="permalink">Zero2Automated - January 2023 Challenge
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  We’ve been seeing a flow of first stagers flying around on Twitter in the form of a OneNote document, so why don’t we all have a look!
https://bazaar.abus...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/pointers/forgor.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/RE-Notes/pointers.html" rel="permalink">Pointers (&amp;memes explained)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">This RE shitpost note was not sponsored by the OALabs Patreon, however if you don’t have it already go and check their awesome content out. I would also like...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/nppspy/shaggy.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Hunts/nppspy.html" rel="permalink">The Curious Case of MPNotify &amp; NPPSPY
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Today’s hunt was inspired from this awesome blog by Dray Agha! Also a special thanks to Robsware for taking the time out his day to proofread this post! Bug,...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/ecthpv2/ecthpv2_logo.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/Course-Reviews/eCTHPv2.html" rel="permalink">My eCTHPv2 Experiences
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">I taken eCTHPv2 back in April, and eventually decided I wanted to write my personal thoughts and overall experience around the course!

</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://www.twitch.tv/malware_guy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitch" aria-hidden="true"></i> Twitch</a></li>
        
      
        
          <li><a href="https://twitter.com/themalwareguy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/MalwareGuy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.youtube.com/channel/UCKLRrI3yzes4p8GpWAdwevg" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-youtube" aria-hidden="true"></i> YouTube</a></li>
        
      
        
          <li><a href="https://discord.gg/kvU3kvt4Qb" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-discord" aria-hidden="true"></i> Discord</a></li>
        
      
        
          <li><a href="https://www.instagram.com/malware_guy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
        
          <li><a href="https://infosec.exchange/@malware_guy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-mastodon" aria-hidden="true"></i> Mastodon</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Malware Guy. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>. PS: If you knowingly stumble upon any malware from my hunts and end up downloading it and infecting yourself, I will point and laugh at you. I hold no liability over the cat's curiosity if it gets the better of them!</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
